<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<title>Biblioteca Musical Digital</title>
<style>
body { font-family: Arial, sans-serif; margin: 20px; }
h1 { margin-bottom: 20px; }
nav { width: 300px; float: left; }
nav ul { list-style: none; padding-left: 10px; }
nav li { margin: 3px 0; cursor: pointer; color: #0066aa; }
nav li:hover { text-decoration: underline; }
.collapsible { font-weight: bold; }
.submenu { display: none; margin-left: 15px; }
#iframeConteudo { width: calc(100% - 320px); height: 600px; border: 1px solid #ccc; float: left; }
#searchInput { width: 280px; padding: 5px; margin-bottom: 10px; }
</style>
</head>
<body>

<h1>ðŸ“š Biblioteca Musical</h1>
<nav>
  <input type="text" id="searchInput" placeholder="Buscar...">
  <div id="menu"></div>
</nav>
<iframe id="iframeConteudo"></iframe>

<script>
// FunÃ§Ã£o para carregar menu
function gerarMenu(data) {
  const menu = document.getElementById('menu');
  menu.innerHTML = '';

  for (const cat in data) {
    const catLi = document.createElement('div');
    catLi.textContent = cat;
    catLi.className = 'collapsible';
    menu.appendChild(catLi);

    const subMenu = document.createElement('div');
    subMenu.className = 'submenu';

    const subcats = data[cat];
    for (const sub in subcats) {
      const subLi = document.createElement('div');
      subLi.textContent = sub;
      subLi.className = 'collapsible';
      subMenu.appendChild(subLi);

      const subSubMenu = document.createElement('ul');
      subcats[sub].forEach(fileObj => {
        const li = document.createElement('li');
        const nome = fileObj.arquivo.split('/').pop().replace('.html','').replace(/-/g,' ');
        li.textContent = nome;
        li.dataset.file = fileObj.arquivo;
        li.dataset.tags = fileObj.tags.join(',');
        li.onclick = () => carregarArquivo(fileObj.arquivo);
        subSubMenu.appendChild(li);
      });
      subMenu.appendChild(subSubMenu);

      // Toggle subsubmenu
      subLi.onclick = () => subSubMenu.style.display = subSubMenu.style.display === 'block' ? 'none' : 'block';
    }
    menu.appendChild(subMenu);

    // Toggle submenu
    catLi.onclick = () => subMenu.style.display = subMenu.style.display === 'block' ? 'none' : 'block';
  }
}

// FunÃ§Ã£o para carregar arquivo no iframe
function carregarArquivo(url) {
  fetch(url)
    .then(res => res.text())
    .then(html => document.getElementById('iframeConteudo').srcdoc = html)
    .catch(err => console.error(err));
}

// FunÃ§Ã£o de busca
document.getElementById('searchInput').addEventListener('input', e => {
  const termo = e.target.value.toLowerCase();
  const items = document.querySelectorAll('nav li');
  items.forEach(li => {
    const texto = li.textContent.toLowerCase();
    const tags = li.dataset.tags ? li.dataset.tags.toLowerCase() : '';
    li.style.display = (texto.includes(termo) || tags.includes(termo)) ? 'block' : 'none';
  });
});

// Carregar JSON do menu
fetch('menu.json')
  .then(res => res.json())
  .then(data => gerarMenu(data))
  .catch(err => console.error(err));

</script>
</body>
</html>
