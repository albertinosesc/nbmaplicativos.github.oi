<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<title>ğŸ¼ DiÃ¡rio Musical</title>
<style>
body {
  font-family: Arial;
  max-width: 800px;
  margin: auto;
  padding: 20px;
}
input {
  margin: 5px;
  padding: 6px;
}
button {
  padding: 6px 10px;
  margin: 5px;
  cursor: pointer;
}
.card {
  border: 1px solid #ccc;
  padding: 10px;
  margin: 10px 0;
}
</style>
</head>
<body>

<h1>ğŸ¼ DiÃ¡rio Musical</h1>

<h2>ğŸ“š Meus Livros</h2>
<div id="livros"></div>

<h3>â• Novo Livro</h3>
<input type="text" id="nomeLivro" placeholder="Nome do Livro">
<input type="text" id="instrumento" placeholder="Instrumento">
<button id="addLivro">Adicionar</button>

<script type="module">

import { initializeApp } from "https://www.gstatic.com/firebasejs/12.9.0/firebase-app.js";
import { getFirestore, collection, addDoc, getDocs, deleteDoc, doc } 
from "https://www.gstatic.com/firebasejs/12.9.0/firebase-firestore.js";

const firebaseConfig = {
  apiKey: "AIzaSyC_3jn_T3hZlcBImj5hUWmnGzmobkTega0",
  authDomain: "diario-musical-394e2.firebaseapp.com",
  projectId: "diario-musical-394e2",
  storageBucket: "diario-musical-394e2.firebasestorage.app",
  messagingSenderId: "547061797104",
  appId: "1:547061797104:web:5af0fba7236e1456e33235"
};

const app = initializeApp(firebaseConfig);
const db = getFirestore(app);

const livrosDiv = document.getElementById("livros");

async function carregarLivros(){
  livrosDiv.innerHTML = "";
  const snapshot = await getDocs(collection(db, "livros"));

  snapshot.forEach(docSnap=>{
    const data = docSnap.data();

    livrosDiv.innerHTML += `
      <div class="card">
        <strong>${data.nome}</strong> - ${data.instrumento}
        <br>
        <a href="livro.html?livro=${docSnap.id}">Abrir</a>
        <button onclick="excluirLivro('${docSnap.id}', '${data.nome}')">Excluir</button>
      </div>
    `;
  });
}

document.getElementById("addLivro").onclick = async () => {
  const nome = document.getElementById("nomeLivro").value;
  const instrumento = document.getElementById("instrumento").value;

  if(!nome) return alert("Digite o nome do livro.");

  await addDoc(collection(db, "livros"), {
    nome,
    instrumento
  });

  location.reload();
};

window.excluirLivro = async (id, nomeLivro) => {

  const confirmar = confirm(
    `âš ï¸ Tem certeza que deseja excluir o livro:\n\n"${nomeLivro}"?\n\nEssa aÃ§Ã£o nÃ£o pode ser desfeita.`
  );

  if(!confirmar) return;

  await deleteDoc(doc(db, "livros", id));

  alert("ğŸ“• Livro excluÃ­do com sucesso!");

  location.reload();
};

carregarLivros();

</script>

</body>
</html>
